---
title: BOSH Lite + UAAをインストールする
tags: ["BOSH", "BOSH-Lite", "UAA"]
categories: ["Dev", "Infrastructure", "BOSH"]
---

[この記事](https://blog.ik.am/entries/415)の延長編。

BOSH Directorの認証に[UAA](https://github.com/cloudfoundry/uaa)を使う方法のメモ。

**目次**
<!-- toc -->

### BOSH Lite作成

`uaa.yml`も追加する。

```
bosh2 create-env bosh.yml \
  --state ./state.json \
  -o virtualbox/cpi.yml \
  -o virtualbox/outbound-network.yml \
  -o bosh-lite.yml \
  -o bosh-lite-runc.yml \
  -o uaa.yml \
  --vars-store ./creds.yml \
  -v director_name="Bosh Lite Director" \
  -v internal_ip=192.168.50.6 \
  -v internal_gw=192.168.50.1 \
  -v internal_cidr=192.168.50.0/24 \
  -v outbound_network_name=NatNetwork
```

### Aliasの設定

```
bosh2 alias-env vbox -e 192.168.50.6 --ca-cert <(bosh2 int ./creds.yml --path /director_ssl/ca)
export BOSH_ENVIRONMENT=192.168.50.6
```

### ログイン

```
$ bosh2 log-in
Email (): admin
Password (): <creds.ymlのadmin_password>

Successfully authenticated with UAA

Succeeded

$ bosh2 vms
Using environment '192.168.50.6' as user 'admin' (openid, bosh.admin)

Succeeded
```
